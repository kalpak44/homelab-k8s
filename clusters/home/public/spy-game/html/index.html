<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Spy Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center px-4">

<!-- MAIN SCREEN -->
<div id="main" class="w-full max-w-md bg-gray-800 p-6 rounded-2xl shadow-lg">
    <h1 class="text-2xl font-bold text-center mb-4" id="title">Игра «Шпион»</h1>

    <!-- LANGUAGE -->
    <label class="block mb-2">Язык / Language / Език:</label>
    <select id="lang" class="w-full bg-gray-700 p-2 rounded mb-4">
        <option value="ru">Русский</option>
        <option value="bg">Български</option>
        <option value="en">English</option>
    </select>

    <div id="hint" class="text-sm text-gray-400 text-center mb-4">
        Каждый игрок по очереди узнаёт свою роль...
    </div>

    <form id="gameForm" class="space-y-4" novalidate>
        <div>
            <label id="playersLabel" class="block mb-1">Количество игроков:</label>
            <input type="number" id="players" min="1"
                   class="w-full px-3 py-2 rounded bg-gray-700 text-white" required/>
            <p id="playersError" class="text-red-500 text-sm mt-1 hidden"></p>
        </div>

        <div>
            <label id="spiesLabel" class="block mb-1">Количество шпионов:</label>
            <input type="number" id="spies" min="1"
                   class="w-full px-3 py-2 rounded bg-gray-700 text-white" required/>
            <p id="spiesError" class="text-red-500 text-sm mt-1 hidden"></p>
        </div>

        <button type="submit" id="startBtn"
                class="w-full bg-blue-600 hover:bg-blue-700 py-2 rounded font-semibold transition">
            Начать игру
        </button>
    </form>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen" class="hidden w-full max-w-md bg-gray-800 p-6 rounded-2xl shadow-lg text-center space-y-6">
    <h2 class="text-xl font-semibold" id="playerCounter">Игрок 1</h2>
    <div id="card" class="bg-gray-700 rounded-xl p-8 text-xl font-bold">
        <span id="cardText">Нажмите "Показать", чтобы узнать роль</span>
    </div>
    <button id="showButton" class="w-full bg-blue-600 hover:bg-blue-700 py-2 rounded font-semibold">Показать</button>
    <button id="nextButton" class="hidden w-full bg-green-600 hover:bg-green-700 py-2 rounded font-semibold">Следующий
        игрок
    </button>
    <button id="homeButton" class="hidden w-full bg-red-600 hover:bg-red-700 py-2 rounded font-semibold">Домой</button>
</div>

<script>
    /* --------------------- WORD LISTS --------------------- */

    const words = {
        ru: [
            "Аэропорт", "Банк", "Библиотека", "Парк", "Пляж", "Школа", "Тюрьма", "Кинотеатр"
        ],
        bg: [
            "Летище", "Банка", "Библиотека", "Парк", "Плаж", "Училище", "Затвор", "Кино"
        ],
        en: [
            "Airport", "Bank", "Library", "Park", "Beach", "School", "Prison", "Cinema"
        ]
    };

    /* --------------------- UI TEXT FOR THREE LANGUAGES --------------------- */

    const ui = {
        ru: {
            title: "Игра «Шпион»",
            hint: "Каждый игрок узнаёт свою роль. Шпион не знает место. Остальные знают.",
            players: "Количество игроков:",
            spies: "Количество шпионов:",
            start: "Начать игру",
            show: "Показать",
            next: "Следующий игрок",
            home: "Домой",
            spy: "Вы — Шпион",
            civilianPlace: "Место:",
            dontShow: "Не показывайте слово другим игрокам.",
            learnRole: "Нажмите «Показать», чтобы узнать роль",
            tryGuess: "Попробуйте понять, где вы.",
            player: "Игрок"
        },
        bg: {
            title: "Игра „Шпионинът“",
            hint: "Всеки играч научава ролята си. Шпионинът не знае мястото.",
            players: "Брой играчи:",
            spies: "Брой шпиони:",
            start: "Започни игра",
            show: "Покажи",
            next: "Следващ играч",
            home: "Начало",
            spy: "Ти си Шпионин",
            civilianPlace: "Място:",
            dontShow: "Не показвайте думата на другите.",
            learnRole: "Натисни „Покажи“, за да видиш ролята",
            tryGuess: "Опитай да разбереш къде си.",
            player: "Играч"
        },
        en: {
            title: "Spy Game",
            hint: "Each player learns their role. The spy doesn't know the place.",
            players: "Number of players:",
            spies: "Number of spies:",
            start: "Start game",
            show: "Show",
            next: "Next player",
            home: "Home",
            spy: "You are the Spy",
            civilianPlace: "Place:",
            dontShow: "Do not show the word to other players.",
            learnRole: "Press “Show” to see your role",
            tryGuess: "Try to guess the place.",
            player: "Player"
        }
    };

    /* --------------------- DOM --------------------- */
    const langSelect = document.getElementById("lang");
    const title = document.getElementById("title");
    const hint = document.getElementById("hint");
    const playersLabel = document.getElementById("playersLabel");
    const spiesLabel = document.getElementById("spiesLabel");
    const startBtn = document.getElementById("startBtn");

    let currentLang = "ru";

    /* Update UI language */
    function applyLanguage(lang) {
        const t = ui[lang];
        title.textContent = t.title;
        hint.textContent = t.hint;
        playersLabel.textContent = t.players;
        spiesLabel.textContent = t.spies;
        startBtn.textContent = t.start;

        document.getElementById("showButton").textContent = t.show;
        document.getElementById("nextButton").textContent = t.next;
        document.getElementById("homeButton").textContent = t.home;
    }

    applyLanguage("ru");

    /* --------------------- GAME LOGIC --------------------- */

    const form = document.getElementById("gameForm");
    const mainScreen = document.getElementById("main");
    const gameScreen = document.getElementById("gameScreen");

    const showButton = document.getElementById("showButton");
    const nextButton = document.getElementById("nextButton");
    const homeButton = document.getElementById("homeButton");

    const cardText = document.getElementById("cardText");
    const playerCounter = document.getElementById("playerCounter");

    let roles = [];
    let currentPlayer = 0;
    let secretWord = "";

    /* Language change */
    langSelect.addEventListener("change", () => {
        currentLang = langSelect.value;
        applyLanguage(currentLang);
    });

    /* Start game */
    form.addEventListener("submit", (e) => {
        e.preventDefault();

        const players = +document.getElementById("players").value;
        const spies = +document.getElementById("spies").value;

        roles = Array(players).fill("civilian");
        for (let i = 0; i < spies; i++) roles[i] = "spy";
        roles.sort(() => Math.random() - 0.5);

        secretWord = words[currentLang][Math.floor(Math.random() * words[currentLang].length)];

        currentPlayer = 0;

        mainScreen.classList.add("hidden");
        gameScreen.classList.remove("hidden");

        updateCard();
    });

    /* Update card info */
    function updateCard() {
        playerCounter.textContent = `${ui[currentLang].player} ${currentPlayer + 1}`;
        cardText.textContent = ui[currentLang].learnRole;

        showButton.classList.remove("hidden");
        nextButton.classList.add("hidden");
        homeButton.classList.add("hidden");
    }

    /* Show role */
    showButton.addEventListener("click", () => {
        if (roles[currentPlayer] === "spy") {
            cardText.innerHTML =
                `<div class="text-red-400 text-2xl font-bold mb-2">${ui[currentLang].spy}</div>
             <div class="text-sm text-gray-300">${ui[currentLang].tryGuess}</div>`;
        } else {
            cardText.innerHTML =
                `<div class="text-green-400 text-2xl font-bold mb-2">${ui[currentLang].civilianPlace} ${secretWord}</div>
             <div class="text-sm text-gray-300">${ui[currentLang].dontShow}</div>`;
        }

        showButton.classList.add("hidden");

        if (currentPlayer < roles.length - 1) nextButton.classList.remove("hidden");
        else homeButton.classList.remove("hidden");
    });

    /* Next player */
    nextButton.addEventListener("click", () => {
        currentPlayer++;
        updateCard();
    });

    /* Return home */
    homeButton.addEventListener("click", () => {
        gameScreen.classList.add("hidden");
        mainScreen.classList.remove("hidden");
        form.reset();
    });
</script>

</body>
</html>
